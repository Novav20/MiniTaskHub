<section>
    <mat-card>
        <div class="filters">
            <mat-form-field appearance="fill">
                <mat-label>Status</mat-label>
                <mat-select [(ngModel)]="statusFilter">
                    <mat-option value="">All</mat-option>
                    @for (status of taskStatusOptions; track $index) {
                    <mat-option value="{{status}}">{{status}}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Due before</mat-label>
                <input matInput type="date" [(ngModel)]="dueDateFilter">
            </mat-form-field>
        </div>
    </mat-card>
    <button mat-raised-button color="primary" (click)="createTask()" class="create-task-btn">+ New Task</button>

    @if (loading) {
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    }
    @if (errorMessage) {
    <mat-card color="warn">{{ errorMessage }}</mat-card>
    }



    @if(tasks.length > 0)
    {
    <ng-container>
        @for (task of filteredTasks; track $index) {
        <mat-card class="task-card">
            <mat-card-title>{{task.title}}</mat-card-title>
            <mat-card-content>
                <p>{{task.description}} </p>
                <p>Status: {{task.status}} </p>
                <p>Due: {{task.dueDate | date}} </p>
            </mat-card-content>
            <mat-card-actions>
                <button mat-button color="warn" (click)="deleteTask(task.id!)">Delete</button>
                <button mat-button color="accent" (click)="editTask(task)">Edit</button>
            </mat-card-actions>
        </mat-card>
        }
    </ng-container>
    }
    @else
    {
    {{noTasks}}
    }
    <ng-template #noTasks>
        <mat-card>No tasks found.</mat-card>
    </ng-template>
</section>